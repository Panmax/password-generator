function hex_password(e,f){var c=sha512.hmac(f,e),g=sha512.hmac("helloworld",c),h=sha512.hmac("\u4F60\u597D\u4E16\u754C",c),a=g.split(""),d=h.split("");console.assert(d.length===a.length,"sha512\u957F\u5EA6\u9519\u8BEF\uFF01");for(var b=0;b<a.length;++b)isNaN(a[b])&&"ilovedagirlandstoppedcontactingbecauseilovedhersomuch217529".search(d[b])> -1&&(a[b]=a[b].toUpperCase());return a.join("")}function seek_password(d,e,f,g){var i="abcdefghijklmnopqrstuvwxyz".split(""),j="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),k="0123456789".split(""),l="~*-+()!@#$^&".split(""),a=i.concat(k);1==parseInt(f)&&(a=a.concat(l)),1==parseInt(g)&&(a=a.concat(j));for(var b=0;b<=d.length-e;++b){var m=d.slice(b,b+parseInt(e)).split(""),n=0,h=m.map(function(b){return n=(n+b.charCodeAt())%a.length}).map(function(b){return a[b]}),c=[!1,!1,!1,!1];if(h.forEach(function(a){c[0]=c[0]||i.includes(a),c[1]=c[1]||j.includes(a),c[2]=c[2]||k.includes(a),c[3]=c[3]||l.includes(a)}),-1==parseInt(g)&&(c[1]=!0),-1==parseInt(f)&&(c[3]=!0),!c.includes(!1))return h.join("")}return""}function get_select_option(c){var a=document.getElementById(c),b=a.selectedIndex;return[a.options[b].value,a.options[b].text]}function generate_password(){var a=document.getElementById("pwd").value,b=document.getElementById("key").value,d=get_select_option("rule_of_punctuation"),e=get_select_option("rule_of_letter"),f=get_select_option("pwd_length");if(a&&b){var c=hex_password(a,b);return console.assert(128===c.length,"hash\u957F\u5EA6\u4E0D\u662F128\u4F4D\uFF01"),seek_password(c,f[0],d[0],e[0])}}